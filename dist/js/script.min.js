var $promoSlider=$("#promoSlider"),currentMousePos={x:-1,y:-1};$(function(){function a(){var a=$("#logo"),b=$(".js-logo__popup",a);a.on("click",".js-logo__pic",function(b){b.preventDefault(),a.addClass("active")}),b.on("click",".js-closer",function(b){b.target.hasAttribute("data-popup-closer")&&a.removeClass("active")})}function b(a){$(this);currentMousePos.x=a.pageX/10,currentMousePos.y=a.pageY/10,$(".interact-bg").css({"-webkit-transform":"translate3d("+-currentMousePos.x+"px,0, 0) scale(1)","-moz-transform":"translate3d("+-currentMousePos.x+"px,0, 0) scale(1)","-o-transform":"translate3d("+-currentMousePos.x+"px,0, 0) scale(1)",transform:"translate3d("+-currentMousePos.x+"px,0, 0) scale(1)"})}a(),$("#fullpage").fullpage({verticalCentered:!0,css3:!0,scrollingSpeed:700,fitToSectionDelay:0,normalScrollElements:".b-contacts__popup, .b-about",fixedElements:".b-video__cont",anchors:["slide_01","slide_02","slide_03"],afterRender:function(){function a(){var a=$(this),b=$(".slick-slide",a).width(),c=$(".b-pic-bg__cont",a),d=$(".js-promo__slide-lnk",a);d.height(b).width(b),c.height(b).width(b);var e=.25;$(this).find(".slick-slide").map(function(a,b){$(b).hasClass("slick-active")?($(b).css({"-webkit-transition-delay":e+"s","transition-delay":e+"s"}),e+=parseFloat(.15)):$(b).css({"-webkit-transition-delay":"0s","transition-delay":"0s"})})}var b=($(this),$("#interactBG"));$(".screen_02"),$(window);$("#bgvid").get(0).play(),$promoSlider.on("init",a),$promoSlider.slick({infinite:!1,slidesToShow:3,slidesToScroll:1,swipeToSlide:!0,touchThreshold:10,edgeFriction:1,arrows:!1,lazyLoad:"progressive",speed:700,cssEase:"cubic-bezier(0.55, 0.085, 0.68, 0.53)",responsive:[{breakpoint:1280,settings:{slidesToShow:2,centerMode:!1}},{breakpoint:600,settings:{slidesToShow:1}}]}),$promoSlider.on("afterChange",function(a,b){var c=0;$(this).find(".slick-slide").map(function(a,b){$(b).hasClass("slick-active")?($(b).css({"-webkit-transition-delay":c+"s","transition-delay":c+"s"}),c+=parseFloat(.15)):$(b).css({"-webkit-transition-delay":"0s","transition-delay":"0s"})})}),$promoSlider.on("setPosition",a),b.prepend('<div class="interact-bg">')},afterLoad:function(a,b,c,d){$("#interactBG")},onLeave:function(a,c,d){var e=$("#interactBG"),f=$(".interact-bg",e),g=$("#promoContact",e),h=($(".screen_02"),$("#header").find(".js-header__awards"));1==a&&($promoSlider.addClass("vertical-animate"),h.css({right:"-145px",top:"-147px",opacity:"0","-webkit-transform":"scale(0)",transform:"scale(0)"}),$("#bgvid").get(0).pause(),$("#bgvid").next().css({opacity:.8})),1==c&&($promoSlider.removeClass("vertical-animate"),h.css({right:"-20px",top:"-20px",opacity:"1","-webkit-transform":"scale(1)",transform:"scale(1)"}),$("#bgvid").get(0).play(),$("#bgvid").next().css({opacity:.4})),3==c?(f.css({"-webkit-transform":"translate3d(-70px, 0, 0) scale(1)","-moz-transform":"translate3d(-70px, 0, 0) scale(1)","-o-transform":"translate3d(-70px, 0, 0) scale(1)",transform:"translate3d(-70px, 0, 0) scale(1)"}),g.fadeIn(1200),$(document).mousemove(b)):(f.css({"-webkit-transform":"translate3d(-70px, 0, 0) scale(1.3)","-moz-transform":"translate3d(-70px, 0, 0) scale(1.3)","-o-transform":"translate3d(-70px, 0, 0) scale(1.3)",transform:"translate3d(-70px, 0, 0) scale(1.3)"}),g.fadeOut(1200))}})}),$(function(){!function(){function a(){c.animate({right:-536},e).queue(function(){$(this).hide(),$(this).dequeue()})}var b=$(".js-form-popup__btn"),c=$(".b-contacts__popup"),d=$(".b-contacts__popup-close",c),e=600;b.click(function(a){a.preventDefault(),c.show().animate({right:0},e)}),d.click(a)}()}),$(function(){!function(){function a(){b=$(this).innerHeight(),$(".b-about").css("height",b)}var b,c,d=$(".js-about__page"),e=$(".js-header__awards");d.click(function(a){var c=d.data("href");b=$(window).innerHeight(),$.ajax({method:"GET",url:c,success:function(a){$("#fullpage").before(a).css("display","none"),$(".b-about").css("height",b),e.css({right:"-145px",top:"-147px",opacity:"0","-webkit-transform":"scale(0)",transform:"scale(0)"}),$(".js-logo__close").css({display:"inline-block"})}})}),$(".js-logo__close").click(function(){$("#fullpage").css("display","block"),e.css({right:"-20px",top:"-20px",opacity:"1","-webkit-transform":"scale(1)",transform:"scale(1)"}),$.fn.fullpage.reBuild(),$(".b-about").remove(),$(".js-logo__close").css({display:"none"})}),$(window).resize(function(){clearTimeout(c),c=setTimeout(a,100)})}()}),$(function(){var a=$("#callbackFrom"),b=($(".js-form-call__btn",a),a.find('input:not([type="file"]), textarea'));!function(){$.validator.addMethod("usPhoneFormat",function(a,b){return this.optional(b)||/^\(\d{3}\) \d{3}\-\d{4}( x\d{1,6})?$/.test(a)},"Невалидный телефон"),$.validator.addMethod("laxEmail",function(a,b){return this.optional(b)||/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@(?:\S{1,63})$/.test(a)},"некорректный email"),a.validate({highlight:function(a,b){$(a).addClass("invalid-elem").removeClass("valid-elem")},unhighlight:function(a,b){$(a).removeClass("invalid-elem").addClass("valid-elem")},errorElement:"div",errorClass:"l-error-message",rules:{userName:{required:!0,minlength:2},userEmail:{email:!0,required:!0},userPhone:{usPhoneFormat:!0,required:!0}},messages:{userName:{required:"Введите ваше имя",minlength:jQuery.validator.format("Минимальная длина {0}")},userEmail:{email:"ваш email адрес должен быть в формате example@example.com",required:"Нам нужен ваш контактный email"},userPhone:{required:"Нам нужен ваш контактный телефон"}},submitHandler:function(b){var c=a.serializeArray();$.post("order",c,function(b){alert(JSON.stringify(c)),a.find(".b-form-call__cont").hide().prev(".b-form-call__title").text(c[1].value+" ваша заявка успешно принята")})}}),b.change(function(b){a.validate().element($(b.target))}),$("#contact-telephone").val("").mask("?(999) 999-9999")}(),$("#fileupload").fileupload({url:"server/php/",dataType:"json",autoUpload:!1,maxFileSize:1e5,acceptFileTypes:/(\.|\/)(doc?x|pdf|zip|jpg|jpeg)$/i}).on("fileuploadadd",function(a,b){var c=[],d=/(\.|\/)(doc?x|pdf|zip|jpg|jpeg)$/i;$.each(b.files,function(a,e){var f=$("<p/>").text(e.name);b.context=$("<div/>").appendTo("#fileupload__files"),b.originalFiles[0].type.length&&!d.test(b.originalFiles[0].type)&&(console.log(111),f.appendTo(b.context).append($('<span class="text-danger"/>').text(" Недопустимое расширение файла")),c.push("Недопустимое расширение файла")),b.originalFiles[0].size>1e5&&(f.appendTo(b.context).append($('<span class="text-danger"/>').text(" Слишком многа букав")),c.push("Слишком многа букав")),0===c.length&&f.appendTo(b.context)})}).on("fileuploaddone",function(a,b){$.each(b.result.files,function(a,b){$('<p style="color: green;">'+b.name+'<i class="elusive-ok" style="padding-left:10px;"/> - Type: '+b.type+" - Size: "+b.size+" byte</p>").appendTo("#div_files")})}).on("fileuploadfail",function(a,b){$.each(b.messages,function(a,b){$('<p style="color: red;">Upload file error: '+b+'<i class="elusive-remove" style="padding-left:10px;"/></p>').appendTo("#div_files")})}).prop("disabled",!$.support.fileInput).parent().addClass($.support.fileInput?void 0:"disabled")});